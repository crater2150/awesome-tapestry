# awesome-tapestry

Command line tool for managing wallpapers in awesomewm.

Tapestry allows setting wallpapers for awesome and storing the settings in a
configuration file. It supports several methods from `gears.wallpaper` and
setting different wallpapers for different screens.

## Installation

Requirements:

- zsh
- awesome's dbus interface must be enabled (i.e. `awesome-client` must be
  working)

Put the contents of this repository inside a folder named `tapestry` in your
awesome config dir (usually `~/.config/awesome`). If your awesome configuration
is managed by git, I recommend adding this repo as a git submodule:

```
git submodule add https://github.com/crater2150/awesome-tapestry.git tapestry
```

Then, in your `rc.lua`:

```lua
require("tapestry")
```

Copy or link `tapestry` to somewhere in your `$PATH`.

## Usage

Use the `tapestry` script to set wallpapers for your screens. It creates a
configuration file in `$your_awesome_config_dir/tapestry/wallpaperrc.lua` (the
directory of this module, if you followed the recommended installation method).

If you just want the same wallpaper on all screens, you can simply use:

```
$ tapestry mywallpaper.jpg
```

### Modes

For more control about the placement, tapestry offers different modes from
`gears.wallpaper`:

#### `-f`, `--fit` (`gears.wallpaper.fit`)

*The default mode*: Fit the wallpaper to the screen dimensions, keeping aspect.
If the screen aspect ratio differs from the images aspect ratio, this will leave
bars on two sides.  The color of those bars can be given with the `-b` or
`--background` switch

#### `-c`, `--centered` (`gears.wallpaper.centered`)

Place the wallpaper centered on the screen without scaling. For wallpapers
smaller than the screen in any dimension, background color can be set as for
`--fit`.

#### `-t`, `--tiled` (`gears.wallpaper.tiled`)

Repeat the wallpaper, if it is smaller than the screen. Starts in top left
corner by default, use `-x` and `-y` to specify an offset.

#### `-m`, `--maximized` (`gears.wallpaper.maximized`)

Set a maximized wallpaper: scale the image up or down with constant aspect
ratio, so that it fills the screen and the image is cut off in at most one axis.
You can use `-x` and `-y` to specify an offset. Note that moving the image in
the direction of the fitting axis causes a black bar, for which awesome does not
have a `background` parameter.

#### `-i`, `--ignore-aspect` (`gears.wallpaper.maximized`, with different parameters)

Fit the wallpaper to the exact screen dimensions, distorting it if needed.

### Multiple screens

You can specify the number of the screen for a wallpaper with `-s` or
`--screen`. If you don't specify a screen, tapestry's default action is to set
the wallpaper for all screens, that *do not have a specific wallpaper yet*.
This means, that it will do nothing visible at all, if you have set wallpapers
for each screen explicitly and don't specify the `--screen` option.

If you want to set the wallpaper for all screens, ignoring previous settings,
use `-w` / `--wipe`. This will clean any configuration before continuing.


## Config file format

The configuration file for tapestry is a simple lua script, containing one
`require` line and a table. Each table entry's key is either a screen number or `default`.
Each entry is a table containing the method from `gears.wallpaper`, the path to
the wallpaper and any additional parameters to the method. Example:

```lua
-- wallpaperrc generated by tapestry
local gears = require("gears")
return {
	[1] = {gears.wallpaper.maximized, '/path/to/screen1.wall', false, {x = 0, y = -200}},
	default = {gears.wallpaper.fit, '/path/to/default.wall'},
}
```

If you edit the file by hand, keep the `return {` and `}` lines as they are, or
the command line tool will no longer be able to parse it. Also, any changes
outside the table will be lost on use of the tool.

In theory, any lua function can be the first entry to a wallpaper table, as long
as it takes the wallpaper as first and the screen (awesome screen object, not
index) as second parameter.
